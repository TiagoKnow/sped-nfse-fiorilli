# sped-nfse-fiorilli

## BETHA-TESTS

## Este pacote atende o provedor FIORILLI

[![Build Status][ico-travis]][link-travis]
[![Coverage Status][ico-scrutinizer]][link-scrutinizer]
[![Quality Score][ico-code-quality]][link-code-quality]

[![Latest Stable Version][ico-stable]][link-packagist]
[![Latest Version on Packagist][ico-version]][link-packagist]
[![License][ico-license]][link-packagist]
[![Total Downloads][ico-downloads]][link-downloads]

[![Issues][ico-issues]][link-issues]
[![Forks][ico-forks]][link-forks]
[![Stars][ico-stars]][link-stars]


## Municípios atendidos pelo provedor

> NOTA: Faltam as URLs dos servidores de Produção desses Municipios, quem desejar usar deve informar essa URL para incluirmos no código.

|n|Município|UF|Ibge|
|:---:|:---|:---:|:---:|
|1|Itacoatiara|AM|1301902|
|2|Macapá|AP|1600303|
|3|Hidrolândia|GO|5209705|
|4|Bacabal|MA|2101202|
|5|Codó|MA|2103307|
|6|Itapecuru Mirim|MA|2105401|
|7|Pedreiras|MA|2108207|
|8|Santa Inês|MA|2109908|
|9|Timon|MA|2112209|
|10|Estiva|MG|3124500|
|11|Itaú de Minas|MG|3133758|
|12|Jacutinga|MG|3134905|
|13|Ouro Fino|MG|3146008|
|14|Santa Rita do Sapucaí|MG|3159605|
|15|Sapucaí-Mirim|MG|3165404|
|16|Sapucaí-Mirim|MG|3165404|
|17|Amambai|MS|5000609|
|18|Chapadão do Sul|MS|5002951|
|19|Corumbá|MS|5003207|
|20|Dois Irmãos do Buriti|MS|5003488|
|21|Nova Alvorada do Sul|MS|5006002|
|22|Paranaíba|MS|5006309|
|23|Barra do Garças|MT|5101803|
|24|Brasnorte|MT|5101902|
|25|Jaciara|MT|5104807|
|26|Lambari D'Oeste|MT|5105234|
|27|Canaã dos Carajás|PA|1502152|
|28|Itaituba|PA|1503606|
|29|Rio Maria|PA|1506161|
|30|Xinguara|PA|1508407|
|31|Floriano|PI|2203909|
|32|Parnaíba|PI|2207702|
|33|Picos|PI|2208007|
|34|Cardoso Moreira|RJ|3301157|
|35|Ariquemes|RO|1100023|
|36|Espigão D´Oeste|RO|1100098|
|37|Jaru|RO|1100114|
|38|Ji-Paraná|RO|1100122|
|39|Machadinho D´Oeste|RO|1100130|
|40|Ouro Preto do Oeste|RO|1100155|
|41|Quatro Irmãos|RS|4315313|
|42|Serafina Corrêa|RS|4320404|
|43|Altinópolis|SP|3501004|
|44|Alvinlândia|SP|3501509|
|45|Américo de Campos|SP|3501806|
|46|Araçoiaba da Serra|SP|3502903|
|47|Assis|SP|3504008|
|48|Bady Bassitt|SP|3504602|
|49|Bálsamo|SP|3504800|
|50|Bariri|SP|3505203|
|51|Brodowski|SP|3507803|
|52|Cabrália Paulista|SP|3508306|
|53|Cajobi|SP|3509304|
|54|Cândido Rodrigues|SP|3510104|
|55|Capela do Alto|SP|3510302|
|56|Cedral|SP|3511300|
|57|Colômbia|SP|3512100|
|58|Cosmorama|SP|3512902|
|59|Dracena|SP|3514403|
|60|Duartina|SP|3514502|
|61|Fernando Prestes|SP|3515608|
|62|Fernandópolis|SP|3515509|
|63|Garça|SP|3516705|
|64|Guaiçara|SP|3517208|
|65|Guaimbê|SP|3517307|
|66|Guaíra|SP|3517406|
|67|Guará|SP|3517703|
|68|Guararapes|SP|3518206|
|69|Holambra|SP|3519055|
|70|Ibaté|SP|3519303|
|71|Ibitinga|SP|3519600|
|72|Igarapava|SP|3520103|
|73|Indiaporã|SP|3520707|
|74|Inúbia Paulista|SP|3520806|
|75|Itajobi|SP|3521903|
|76|José Bonifácio|SP|3525706|
|77|Junqueirópolis|SP|3526001|
|78|Laranjal Paulista|SP|3526407|
|79|Martinópolis|SP|3529203|
|80|Miguelópolis|SP|3529708|
|81|Mirandópolis|SP|3530102|
|82|Mirassolândia|SP|3530409|
|83|Mongaguá|SP|3531100|
|84|Monte Aprazível|SP|3531407|
|85|Morungaba|SP|3532009|
|86|Nova Aliança|SP|3532801|
|87|Nova Granada|SP|3533007|
|88|Novo Horizonte|SP|3533502|
|89|Palmares Paulista|SP|3535101|
|90|Panorama|SP|3535408|
|91|Patrocínio Paulista|SP|3536307|
|92|Paulo de Faria|SP|3536604|
|93|Pedreira|SP|3537107|
|94|Pirajuí|SP|3538907|
|95|Pirangi|SP|3539004|
|96|Pirapozinho|SP|3539202|
|97|Pontal|SP|3540200|
|98|Potirendaba|SP|3540804|
|99|Promissão|SP|3541604|
|100|Quatá|SP|3541703|
|101|Queiroz|SP|3541802|
|102|Ribeirão Bonito|SP|3542909|
|103|Ribeirão Corrente|SP|3543105|
|104|Rio das Pedras|SP|3544004|
|105|Riolândia|SP|3544202|
|106|Sabino|SP|3544608|
|107|Sales|SP|3544806|
|108|Sales Oliveira|SP|3544905|
|109|Salto de Pirapora|SP|3545308|
|110|Santo Anastácio|SP|3547700|
|111|Santo Antônio de Posse|SP|3548005|
|112|São Joaquim da Barra|SP|3549409|
|113|Serra Azul|SP|3551405|
|114|Serra Negra|SP|3551603|
|115|Sud Mennucci|SP|3552304|
|116|Ubarana|SP|3555356|
|117|Urânia|SP|3555802|


## Observações

- Recomenda-se a utilização do envio síncrono, pois as notas enviadas no envio assíncrono são processadas somente as 2h da manhã de cada dia;
- É obrigatório a informação de login e senha para todos os métodos de comunicação.
- Para a emissão das notas no ambiente de homologação deve ser utilizado os dados de um usuário de testes liberado pela prefeitura: CNPJ=01001001000113, IM:15000, Login=01001001000113, Senha=123456, cMun: 3504800, aliquta: 2%, codigo do serviço: 01.05 , ExigibilidadeISS: 1 – Exigível;  RegimeEspecialTributacao: vazio, OptanteSimplesNacional: 2 – Não, IncentivoFiscal: 2 – Não;
- No cancelamento, pode-se informar o parâmetro CodigoCancelamento. Se este não for informado, o componente assumirá este valor como 2 (Serviço não prestado).
- No cancelamento em Homologação, o parâmetro extra CodigoMunicipio a ser informado deverá ser 3504800, pois o servidor de Homologação é situado em Bálsamo - SP;
- Através do site de NFSe disponibilizado pela prefeitura da cidade é possível emitir notas com mais de um item, porém pelo WebService não é possível de acordo com o schemas.xsd. Ao consultar notas emitidas com mais de um item é retornado apenas o último item da nota. Devido a isso não é possível emitir e imprimir notas com mais de um item.

- O código do serviço segue o que está descrito na LC-116.
- O padrão em questão possui uma formatação diferente para o código de tributação do município. O formato é o código da atividade (000010) + código atividade desdobro (0000005). Ess informação pode ser encontrada no portal da cidade, na opção "Consultar alíquotas".
- O código CNAE não tem nenhuma informação específica, mas também não é obrigatório. 

## Dependências

- PHP >= 7.1
- ext-curl
- ext-soap
- ext-zlib
- ext-dom
- ext-openssl
- ext-json
- ext-simplexml
- ext-libxml

### Outras Libs

- nfephp-org/sped-common
- justinrainbow/json-schema


## Contribuindo
Este é um projeto totalmente *OpenSource*, para usa-lo e modifica-lo você não paga absolutamente nada. Porém para continuarmos a mante-lo é necessário qua alguma contribuição seja feita, seja auxiliando na codificação, na documentação ou na realização de testes e identificação de falhas e BUGs.

**Este pacote está listado no [Packgist](https://packagist.org/)**

*Durante a fase de desenvolvimento e testes este pacote deve ser instalado com:*
```bash
composer require nfephp-org/sped-nfse-fiorilli:dev-master
```

*Ou ainda,*
```bash
composer require nfephp-org/sped-nfse-fiorilli:dev-master --prefer-dist
```

*Ou ainda alterando o composer.json do seu aplicativo inserindo:*
```json
"require": {
    "nfephp-org/sped-nfse-fiorilli" : "dev-master"
}
```

> NOTA: Ao utilizar este pacote ainda na fase de desenvolvimento não se esqueça de alterar o composer.json da sua aplicação para aceitar pacotes em desenvolvimento, alterando a propriedade "minimum-stability" de "stable" para "dev".
> ```json
> "minimum-stability": "dev",
> "prefer-stable": true
> ```

*Após os stable realeases estarem disponíveis, este pacote poderá ser instalado com:*
```bash
composer require nfephp-org/sped-nfse-fiorilli
```
Ou ainda alterando o composer.json do seu aplicativo inserindo:
```json
"require": {
    "nfephp-org/sped-sped-nfse-fiorilli" : "^1.0"
}
```

## Forma de uso
vide a pasta *Examples*

## Log de mudanças e versões
Acompanhe o [CHANGELOG](CHANGELOG.md) para maiores informações sobre as alterações recentes.

## Testing

Todos os testes são desenvolvidos para operar com o PHPUNIT

## Security

Caso você encontre algum problema relativo a segurança, por favor envie um email diretamente aos mantenedores do pacote ao invés de abrir um ISSUE.

## Credits

Roberto L. Machado (owner and developer)

## License

Este pacote está diponibilizado sob LGPLv3 ou MIT License (MIT). Leia  [Arquivo de Licença](LICENSE.md) para maiores informações.

[ico-stable]: https://poser.pugx.org/nfephp-org/sped-nfse-fiorilli/version
[ico-stars]: https://img.shields.io/github/stars/nfephp-org/sped-nfse-fiorilli.svg?style=flat-square
[ico-forks]: https://img.shields.io/github/forks/nfephp-org/sped-nfse-fiorilli.svg?style=flat-square
[ico-issues]: https://img.shields.io/github/issues/nfephp-org/sped-nfse-fiorilli.svg?style=flat-square
[ico-travis]: https://img.shields.io/travis/nfephp-org/sped-nfse-fiorilli/master.svg?style=flat-square
[ico-scrutinizer]: https://img.shields.io/scrutinizer/coverage/g/nfephp-org/sped-nfse-fiorilli.svg?style=flat-square
[ico-code-quality]: https://img.shields.io/scrutinizer/g/nfephp-org/sped-nfse-fiorilli.svg?style=flat-square
[ico-downloads]: https://img.shields.io/packagist/dt/nfephp-org/sped-nfse-fiorilli.svg?style=flat-square
[ico-version]: https://img.shields.io/packagist/v/nfephp-org/sped-nfse-fiorilli.svg?style=flat-square
[ico-license]: https://poser.pugx.org/nfephp-org/nfephp/license.svg?style=flat-square
[ico-gitter]: https://img.shields.io/badge/GITTER-4%20users%20online-green.svg?style=flat-square


[link-packagist]: https://packagist.org/packages/nfephp-org/sped-nfse-fiorilli
[link-travis]: https://travis-ci.org/nfephp-org/sped-nfse-fiorilli
[link-scrutinizer]: https://scrutinizer-ci.com/g/nfephp-org/sped-nfse-fiorilli/code-structure
[link-code-quality]: https://scrutinizer-ci.com/g/nfephp-org/sped-nfse-fiorilli
[link-downloads]: https://packagist.org/packages/nfephp-org/sped-nfse-fiorilli
[link-author]: https://github.com/nfephp-org
[link-issues]: https://github.com/nfephp-org/sped-nfse-fiorilli/issues
[link-forks]: https://github.com/nfephp-org/sped-nfse-fiorilli/network
[link-stars]: https://github.com/nfephp-org/sped-nfse-fiorilli/stargazers